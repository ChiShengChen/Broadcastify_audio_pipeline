# 全面文字預處理指南

## 概述

除了數字和特殊符號之外，還有許多重要的文字預處理項目需要注意。本指南基於對 EMS 無線電通訊數據的深入分析，提供了全面的預處理建議。

## 關鍵發現

### 📊 **分析結果摘要**

基於對 9 個文件的詳細分析，發現了以下重要模式：

| 預處理項目 | 出現次數 | 唯一項目數 | 優先級 |
|------------|----------|------------|--------|
| **噪音標記** | 155 | 1 | 🔴 高 |
| **單位識別符** | 215 | 39 | 🟡 中 |
| **不完整句子** | 102 | 12 | 🟡 中 |
| **俚語術語** | 93 | 11 | 🟡 中 |
| **緊急代碼** | 91 | 61 | 🔴 高 |
| **位置術語** | 86 | 19 | 🟡 中 |
| **重複詞** | 83 | 45 | 🟢 低 |
| **時間表達** | 61 | 35 | 🟡 中 |
| **醫療術語** | 54 | 11 | 🟡 中 |
| **縮寫形式** | 39 | 12 | 🟡 中 |
| **測量單位** | 16 | 14 | 🟡 中 |
| **縮寫** | 8 | 6 | 🔴 高 |
| **填充詞** | 8 | 3 | 🟢 低 |
| **音標拼寫** | 8 | 3 | 🟢 低 |
| **技術術語** | 3 | 1 | 🟢 低 |

## 🔴 **高優先級項目**

### 1. 噪音標記處理
**問題**：`[x]` 標記在數據中出現 155 次
- **影響**：影響文本匹配和語義理解
- **解決方案**：移除或標準化為 "x"

### 2. 縮寫標準化
**常見縮寫**：
- `EMS` → `emergency medical services`
- `BLS` → `basic life support`
- `ALS` → `advanced life support`
- `PD` → `police department`
- `CPR` → `cardiopulmonary resuscitation`

### 3. 緊急代碼標準化
**問題**：電話代碼、地址號碼、時間格式不一致
- `6-1-2` → `six one two`
- `11:17` → `eleven seventeen`
- `1541` → `fifteen forty one`

## 🟡 **中優先級項目**

### 1. 單位識別符標準化
**常見單位**：
- `engine` (52次)
- `command` (24次)
- `ladder` (17次)
- `rescue` (16次)
- `ambulance` (12次)

### 2. 醫療術語標準化
**常見醫療術語**：
- `breathing` (14次)
- `conscious` (11次)
- `patient` (8次)
- `male` (7次)
- `female` (6次)

### 3. 位置術語標準化
**常見位置詞**：
- `on scene` (15次)
- `road` (13次)
- `en route` (10次)
- `west` (7次)
- `unit` (5次)

### 4. 不完整句子處理
**常見短語**：
- `copy` (24次)
- `clear` (20次)
- `on scene` (15次)
- `go ahead` (10次)
- `out` (10次)

### 5. 縮寫形式標準化
**常見縮寫**：
- `we're` (15次)
- `we'll` (5次)
- `we've` (4次)
- `you're` (3次)
- `it's` (3次)

### 6. 時間表達標準化
**常見時間表達**：
- `now` (7次)
- `at 11:18` (3次)
- `11:18` (3次)
- `12:08` (3次)
- `at 14:30` (3次)

### 7. 測量單位標準化
**常見測量**：
- `60 year old` (2次)
- `82 year old` (2次)
- `48 year old` (1次)
- `40 year old` (1次)
- `77 year old` (1次)

## 🟢 **低優先級項目**

### 1. 填充詞處理
**常見填充詞**：
- `so` (5次)
- `like` (2次)
- `actually` (1次)

### 2. 重複詞處理
**過度重複的詞**：
- `[x]` (9次)
- `the` (8次)
- `engine` (5次)

### 3. 音標拼寫標準化
**常見音標**：
- `bravo` (4次)
- `charlie` (2次)
- `alpha` (2次)

### 4. 技術術語標準化
**常見技術術語**：
- `water supply` (3次)

## 🛠️ **實施建議**

### 1. 分階段實施
```
階段 1: 高優先級項目
├── 噪音標記處理
├── 縮寫標準化
└── 緊急代碼標準化

階段 2: 中優先級項目
├── 單位識別符標準化
├── 醫療術語標準化
├── 位置術語標準化
├── 不完整句子處理
├── 縮寫形式標準化
├── 時間表達標準化
└── 測量單位標準化

階段 3: 低優先級項目
├── 填充詞處理
├── 重複詞處理
├── 音標拼寫標準化
└── 技術術語標準化
```

### 2. 模式選擇策略

**保守模式**：
- 只處理高優先級項目
- 保持原始語義
- 最小化變更

**激進模式**：
- 處理所有優先級項目
- 最大化標準化
- 可能改變語義

### 3. 上下文考慮

**重要原則**：
1. **保持專業術語準確性**
2. **考慮上下文重要性**
3. **平衡標準化與語義保持**
4. **根據 ASR 模型特性調整**

## 📋 **預處理檢查清單**

### 高優先級檢查項目
- [ ] 移除或標準化 `[x]` 標記
- [ ] 標準化專業縮寫 (EMS, BLS, ALS, PD)
- [ ] 標準化緊急代碼格式
- [ ] 處理特殊字符

### 中優先級檢查項目
- [ ] 標準化單位識別符
- [ ] 統一醫療術語
- [ ] 標準化位置術語
- [ ] 處理不完整句子
- [ ] 標準化縮寫形式
- [ ] 統一時間表達
- [ ] 標準化測量單位

### 低優先級檢查項目
- [ ] 移除填充詞
- [ ] 處理重複詞
- [ ] 標準化音標拼寫
- [ ] 統一技術術語

## 🔧 **工具使用**

### 使用增強版預處理器

```bash
# 保守模式
python3 enhanced_ground_truth_preprocessor.py \
    --input_file ground_truth.csv \
    --output_file processed_ground_truth.csv \
    --mode conservative

# 激進模式
python3 enhanced_ground_truth_preprocessor.py \
    --input_file ground_truth.csv \
    --output_file processed_ground_truth.csv \
    --mode aggressive

# 預覽模式
python3 enhanced_ground_truth_preprocessor.py \
    --input_file ground_truth.csv \
    --output_file processed_ground_truth.csv \
    --mode conservative \
    --preview
```

### 在 Pipeline 中使用

```bash
# 使用增強版預處理
./run_pipeline.sh \
    --input_dir /path/to/audio \
    --output_dir /path/to/results \
    --preprocess-ground-truth \
    --preprocess-mode aggressive
```

## 📊 **效果評估**

### 預期改善
1. **提高文件匹配率**：標準化格式減少匹配失敗
2. **改善 WER 計算**：減少不必要的錯誤
3. **提高評估一致性**：統一格式標準
4. **增強語義理解**：標準化專業術語

### 注意事項
1. **保持語義準確性**：避免過度標準化
2. **考慮上下文**：某些變更可能影響語義
3. **測試驗證**：在不同模型上測試效果
4. **文檔記錄**：記錄所有預處理變更

## 🎯 **最佳實踐**

### 1. 漸進式實施
- 從高優先級項目開始
- 逐步添加中低優先級項目
- 持續監控效果

### 2. 模型特定調整
- 根據 ASR 模型特性調整策略
- 考慮模型的訓練數據特點
- 平衡標準化與模型適應性

### 3. 質量控制
- 建立預處理檢查清單
- 定期審查預處理效果
- 收集用戶反饋

### 4. 持續改進
- 監控新的模式出現
- 更新預處理規則
- 優化處理策略

## 📈 **結論**

全面的文字預處理不僅包括數字和特殊符號，還需要考慮：

1. **專業術語標準化**：確保醫療和緊急服務術語的一致性
2. **格式統一**：標準化各種代碼和標識符
3. **語義保持**：在標準化的同時保持原始語義
4. **上下文考慮**：根據具體應用場景調整策略

通過系統性的預處理，可以顯著提高 ASR 評估的準確性和一致性，為實際應用提供更可靠的基礎。 